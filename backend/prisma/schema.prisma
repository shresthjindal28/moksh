generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Admin {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String   @map("password_hash")
  name         String
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  media Media[]
}

model Category {
  id          String    @id @default(cuid())
  name        String
  slug        String    @unique
  description String?
  order       Int       @default(0)
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  products Product[]
}

model Product {
  id              String    @id @default(cuid())
  name            String
  description     String?
  price           Float?
  categoryId      String    @map("category_id")
  images         String[]   @default([])
  whatsappNumber String?   @map("whatsapp_number")
  isActive        Boolean   @default(true) @map("is_active")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  category Category @relation(fields: [categoryId], references: [id], onDelete: Restrict)
  leads   Lead[]
}

model Media {
  id          String   @id @default(cuid())
  url         String
  publicId    String?  @map("public_id")
  filename    String   @map("filename")
  mimeType    String   @map("mime_type")
  size        Int
  uploadedById String  @map("uploaded_by_id")
  createdAt   DateTime @default(now()) @map("created_at")

  uploadedBy Admin @relation(fields: [uploadedById], references: [id])
}

model Settings {
  id                     String   @id @default(cuid())
  defaultWhatsappNumber  String   @default("") @map("default_whatsapp_number")
  whatsappMessageTemplate String  @default("Hi, I'm interested in {productName}") @map("whatsapp_message_template")
  updatedAt              DateTime @updatedAt @map("updated_at")
}

model Lead {
  id         String    @id @default(cuid())
  productId  String?   @map("product_id")
  clickedAt  DateTime  @default(now()) @map("clicked_at")
  metadata   Json?

  product Product? @relation(fields: [productId], references: [id])
}
